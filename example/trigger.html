<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Sep 15, 2012
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20120915" />
    <meta http-equiv="Content-Language" content="en" />
    <title></title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                    <a href="http://www.pi4j.com/" id="bannerLeft">
                                                                                                <img src="../images/logos/pi4j-header-small3.png"  alt="Pi4J"/>
                </a>
                      </div>
        <div class="pull-right">                  <a href="http://www.raspberrypi.org/" id="bannerRight">
                                                                                                <img src="../images/logos/trademarks.png"  alt="The Pi4J Project"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2012-09-15</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.0.1-SNAPSHOT</li>
                      
                
            
      
                                              
    <li class="pull-right">              <a href="http://www.savagehomeautomation.com/" class="externalLink" target="_blank" title="Blog">
        Blog</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="https://github.com/Pi4J/pi4j/wiki/" class="externalLink" target="pi4j-github" title="Wiki">
        Wiki</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="https://github.com/Pi4J/pi4j/issues/" class="externalLink" target="pi4j-github" title="Issues">
        Issues</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="https://github.com/Pi4J/pi4j/" class="externalLink" target="pi4j-github" title="Github">
        Github</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://www.pi4j.com/" class="externalLink" title="Home">
        Home</a>
  </li>

                        </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">Pi4J</li>
                                
      <li>
    
                          <a href="../index.html" title="Welcome">
          <i class="none"></i>
        Welcome</a>
            </li>
                  
      <li>
    
                          <a href="../team-list.html" title="The Team">
          <i class="none"></i>
        The Team</a>
            </li>
                  
      <li>
    
                          <a href="../faq.html" title="FAQ">
          <i class="none"></i>
        FAQ</a>
            </li>
                  
      <li>
    
                          <a href="../license.html" title="License">
          <i class="none"></i>
        License</a>
            </li>
                  
      <li>
    
                          <a href="../dependency.html" title="Dependencies">
          <i class="none"></i>
        Dependencies</a>
            </li>
                  
      <li>
    
                          <a href="../release-notes.html" title="Release Notes">
          <i class="none"></i>
        Release Notes</a>
            </li>
                  
      <li>
    
                          <a href="../download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                  
      <li>
    
                          <a href="../install.html" title="Installation">
          <i class="none"></i>
        Installation</a>
            </li>
                  
      <li>
    
                          <a href="../usage.html" title="Usage">
          <i class="none"></i>
        Usage</a>
            </li>
                  
      <li>
    
                          <a href="../apidocs/index.html" target="pi4j-javadoc" title="JavaDoc">
          <i class="none"></i>
        JavaDoc</a>
            </li>
                              <li class="nav-header">Examples</li>
                                
      <li>
    
                          <a href="../example/control.html" title="Control GPIO">
          <i class="none"></i>
        Control GPIO</a>
            </li>
                  
      <li>
    
                          <a href="../example/listener.html" title="Listen for GPIO Events">
          <i class="none"></i>
        Listen for GPIO Events</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Trigger GPIO on Events</a>
          </li>
                  
      <li>
    
                          <a href="../example/serial.html" title="Serial Communication">
          <i class="none"></i>
        Serial Communication</a>
            </li>
                  
      <li>
    
                          <a href="../example/system-info.html" title="System/Network Information">
          <i class="none"></i>
        System/Network Information</a>
            </li>
                              <li class="nav-header">Project Development</li>
                                
      <li>
    
                          <a href="../project-info.html" title="Project Information">
          <i class="none"></i>
        Project Information</a>
            </li>
                  
      <li>
    
                          <a href="../project-reports.html" title="Project Reports">
          <i class="none"></i>
        Project Reports</a>
            </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="http://www.raspberrypi.org/" title="RaspberryPi" class="builtBy">
        <img class="builtBy"  alt="RaspberryPi" src="../images/logos/raspberrypi.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section"><h2>GPIO Triggers Example using Pi4J.<a name="GPIO_Triggers_Example_using_Pi4J."></a></h2><p>The following example demonstrates how to setup GPIO triggers. GPIO Triggers listen for pin state changes and then perform some action on on alternate GPIO pin or perform a callback to a user specified method. Pi4J includes several built in pre-defined trigger implementation classes or you can create your own trigger by implementing the GpioTrigger interface. Triggers are based on the GPIO listener implementation and rely on GPIO hardware interrupts not state polling.</p><div class="section"><h3>Source Code <a name="Source_Code"></a></h3><p>The source code for this example is included in the github repository: <a class="externalLink" href="https://github.com/Pi4J/pi4j/tree/master/src/test/java/com/pi4j/example">https://github.com/Pi4J/pi4j/tree/master/src/test/java/com/pi4j/example</a></p><div class="source"><pre class="prettyprint">package com.pi4j.example;

/*
 * #%L
 * **********************************************************************
 * ORGANIZATION  :  Pi4J
 * PROJECT       :  Pi4J :: Java Library
 * FILENAME      :  TriggerGpioExample.java  
 * 
 * This file is part of the Pi4J project. More information about 
 * this project can be found here:  http://www.pi4j.com/
 * **********************************************************************
 * %%
 * Copyright (C) 2012 Pi4J
 * %%
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *      http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * #L%
 */


import java.util.concurrent.Callable;

import com.pi4j.io.gpio.Gpio;
import com.pi4j.io.gpio.GpioFactory;
import com.pi4j.io.gpio.GpioPin;
import com.pi4j.io.gpio.Pin;
import com.pi4j.io.gpio.PinEdge;
import com.pi4j.io.gpio.PinResistor;
import com.pi4j.io.gpio.PinState;
import com.pi4j.io.gpio.trigger.GpioCallbackTrigger;
import com.pi4j.io.gpio.trigger.GpioPulseStateTrigger;
import com.pi4j.io.gpio.trigger.GpioSetStateTrigger;
import com.pi4j.io.gpio.trigger.GpioSyncStateTrigger;

/**
 * This example code demonstrates how to setup simple triggers for GPIO pins on the Raspberry Pi.
 * 
 * @author Robert Savage
 */
public class TriggerGpioExample
{
    public static void main(String[] args) throws InterruptedException
    {
        // create gpio controller
        Gpio gpio = GpioFactory.createInstance();

        // provision gpio pin #4 as an input pin with its internal pull down resistor enabled
        // (configure pin edge to both rising and falling to get notified for HIGH and LOW state
        // changes)
        GpioPin myButton = gpio.provisionInputPin(Pin.GPIO_04, &quot;MyButton&quot;, PinEdge.BOTH, PinResistor.PULL_DOWN);

        // setup gpio pins #21,22,23 as an output pins and make sure they are all LOW at startup
        GpioPin myLed[] = { 
                gpio.provisionOuputPin(Pin.GPIO_21, &quot;LED #1&quot;, PinState.LOW), 
                gpio.provisionOuputPin(Pin.GPIO_22, &quot;LED #2&quot;, PinState.LOW),
                gpio.provisionOuputPin(Pin.GPIO_23, &quot;LED #3&quot;, PinState.LOW) };
        
        // create a gpio control trigger on gpio pin #4; when #4 goes HIGH, also set pin #21 to HIGH
        myButton.addTrigger(new GpioSetStateTrigger(PinState.HIGH, myLed[0], PinState.HIGH));

        // create a gpio control trigger on gpio pin #4; when #4 goes LOW, also set pin #21 to LOW
        myButton.addTrigger(new GpioSetStateTrigger(PinState.LOW, myLed[0], PinState.LOW));
        
        // create a gpio synchronization trigger on gpio pin#4; when #4 changes, also set pin #22 to
        // same state
        myButton.addTrigger(new GpioSyncStateTrigger(myLed[1]));

        // create a gpio pulse trigger on gpio pin#4; when #4 goes HIGH, also pulse pin #23 to the
        // HIGH state for 1 second
        myButton.addTrigger(new GpioPulseStateTrigger(PinState.HIGH, myLed[2], 1000));
        
        // create a gpio callback trigger on gpio pin#4; when #4 changes state, perform a callback
        // invocation on the user defined 'Callable' class instance
        myButton.addTrigger(new GpioCallbackTrigger(new Callable&lt;Void&gt;()
                {
                    public Void call() throws Exception
                    {
                        System.out.println(&quot; --&gt; GPIO TRIGGER CALLBACK RECEIVED &quot;);
                        return null;
                    }
                }));

        // keep program running until user aborts (CTRL-C)
        for (;;)
        {
            Thread.sleep(500);
        }
    }
}
</pre></div></div><div class="section"><h3>Wiring Diagram<a name="Wiring_Diagram"></a></h3><p>The following circuit can be used in conjunction with this sample code.</p><img src="../images/gpio-trigger-example.png" alt="" /></div><div class="section"><h3>Compile<a name="Compile"></a></h3><p>First, copy the <i>TriggerGpioExample.java</i> source file to a directory on the RaspberryPi.<br />Next, use the following command to compile this example program:</p><p><tt>javac -cp /usr/share/java/pi4j.jar -d TriggerGpioExample.java</tt></p></div><div class="section"><h3>Execute<a name="Execute"></a></h3><p>The following command will run this example program:</p><p><tt>sudo java -Djava.library.path=/usr/local/lib -classpath .:/usr/share/java/pi4j.jar com.pi4j.example.TriggerGpioExample</tt></p></div><div class="section"><h3>Output<a name="Output"></a></h3><p>The LED attached to GPIO pin 21 should turn ON when the momentary button is pressed and OFF when the button is released.</p><p>The LED attached to GPIO pin 22 should turn ON when the momentary button is pressed and OFF when the button is released.</p><p>The LED attached to GPIO pin 23 should turn ON for 1 second when the momentary button is pressed. The button release has no effect on this LED.</p><p>The following message should be displayed on the console each time the momentary button is pressed and again when released.</p><p><tt> --&gt; GPIO TRIGGER CALLBACK RECEIVED </tt></p></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2012
                        <a href="http://www.pi4j.com">Pi4J</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
